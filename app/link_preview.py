import requests
from bs4 import BeautifulSoup
import validators


def extract_link_preview(url):
    if not validators.url(url):
        return None

    try:
        response = requests.get(url, timeout=5)
        soup = BeautifulSoup(response.content, "html.parser")

        title = soup.title.string if soup.title else ""
        description = ""
        image = ""

        # محاولة استخراج الوصف
        meta_desc = soup.find("meta", attrs={"name": "description"})
        og_desc = soup.find("meta", property="og:description")
        if meta_desc:
            description = meta_desc["content"]
        elif og_desc:
            description = og_desc["content"]

        # محاولة استخراج الصورة
        og_image = soup.find("meta", property="og:image")
        if og_image:
            image = og_image["content"]

        return {"title": title, "description": description, "image": image, "url": url}
    except Exception as e:
        print(f"Error extracting link preview: {e}")
        return None


# لدي هذه المشروع اريد منك ان تقوم بمراجعته بشكل دقيق جدا جدا وتكون المراجعة شامله تشمل الملفات الرئيسية والفرعية وجميع الميزات ولاخاصيات وكل حرف وكلمه والمهمه الثانيه اعطني تقرير كامل بجميع الميزات والخاصيات والاشياء الموجوده به


# 1. عند تقديم ميزة جديدة لإضافتها للمشروع، قدّم لي إرشادات دقيقة حول كيفية دمجها بشكل صحيح مع جميع الملفات الرئيسية والفرعية.
# 2. تأكد من أن إضافة الميزة الجديدة لا تسبب أي تعارض أو أخطاء في بقية المزايا الموجودة في المشروع.
# 3. تحقق مما إذا كانت الميزة الجديدة موجودة بالفعل؛ إذا كانت كذلك، زودني باقتراحات لتحسينها أو دمجها بشكل أكثر كفاءة.
# 4. في كل مرة أطلب إضافة ميزة جديدة، تأكد من أن المشروع لا يزال يعمل بكفاءة وتوافق تام.
# 5. إذا كان هناك تحسين للميزة المقترحة، قدم لي هذا التحسين لتطبيقه.
# 6. بعد التأكد من نجاح إضافة الميزة، انتقل مباشرةً إلى الميزة التالية بناءً على التعليمات التي سأقدمها.
# مع الرجوع للملفات التي قدمتها:
# 7. عند تقديم الإرشادات والإضافات، اعتمد على الملفات التي قمت بتقديمها سابقًا لضمان التكامل بين الميزة الجديدة والمشروع الحالي.
# 8. إذا كانت الملفات السابقة تحتاج إلى تعديلات لتتناسب مع الميزة الجديدة، قدّم إرشادات محددة حول كيفية تعديلها أو تحديثها لتحقيق التكامل المطلوب.
# 9. التحقق ما اذا كانت الميزه موجوده بالفعل


# ترتيب الملفات: قم بترتيب الملفات بشكل صحيح، وأزل أي عناصر غير ضرورية. في حال كانت هناك مكونات ناقصة، أكملها بناءً على الهيكل الأساسي للمشروع.
# التحقق من التوافق: تحقق من أن جميع الملفات الرئيسية والفرعية متوافقة بشكل مثالي، مما يضمن أن الموقع يعمل بكفاءة ودون أخطاء.
# إضافة ميزات جديدة: عند تقديم ميزة جديدة، قدم لي إرشادات دقيقة ومفصلة حول كيفية دمجها بشكل صحيح مع جميع الملفات الأساسية والفرعية.
# ضمان عدم حدوث تعارض: تأكد من أن الميزة الجديدة لا تسبب أي تعارض أو أخطاء في المشروع بأكمله. إذا حدث ذلك، قدّم الحلول اللازمة لتجنب المشكلة.
# التحقق من الميزات الموجودة: قبل إضافة ميزة جديدة، تحقق مما إذا كانت موجودة بالفعل في المشروع. إذا كانت كذلك، زودني باقتراحات لتحسينها أو دمجها بشكل أكثر كفاءة.
# ضمان الأداء والكفاءة: في كل مرة أطلب فيها إضافة ميزة جديدة، تأكد من أن المشروع لا يزال يعمل بكفاءة وتوافق تام.
# تقديم تحسينات الميزات: إذا كان هناك تحسين للميزة المقترحة، قدّم لي هذا التحسين لتطبيقه وجعل المشروع أفضل.
# الاستمرارية في العمل: بعد التأكد من نجاح إضافة الميزة، انتقل مباشرةً إلى الميزة التالية بناءً على التعليمات التي سأقدمها.
# الاعتماد على الملفات السابقة: عند تقديم الإرشادات أو إضافة ميزات جديدة، اعتمد على الملفات التي قدمتها سابقًا لضمان التكامل بين الميزة الجديدة والمشروع الحالي.
# تعديل الملفات لتحقيق التكامل: إذا كانت الملفات السابقة تحتاج إلى تعديلات لتتناسب مع الميزة الجديدة، قدم إرشادات محددة حول كيفية تعديلها أو تحديثها لتحقيق التكامل المطلوب.
# التحقق المستمر لتفادي الأخطاء: تأكد من التحقق المستمر من الملفات المقدمة لتفادي أي أخطاء أو تعارضات، وضمان انسجام المشروع بشكل كامل


# خاصية اللغات تشمل جميع اللغات والمستخدم يختار ويتم تعين اللغة الافتراضيا ب اللغة العربية في الموقع والترجمه الفوري للبوستات والمقالات والكومنت والرسائل
